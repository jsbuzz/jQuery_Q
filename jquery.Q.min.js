/*! jQuery.Q.js - v1.1 - 2014-03-12
* https://github.com/jsbuzz/jQuery_Q
* Copyright (c) 2014 Matyas Buczko; Licensed GPL2 */
!function(e){function r(e){return(typeof e.done+typeof e.fail+typeof e.state).match(/(function){3}/)}e.Q=function(n){var t=Array.prototype.slice.call(arguments,1);if("string"==typeof n)n=e.Q[n];else if(r(n))return n;return function(){return n.apply(n,t)}},e.Q.bound=function(e,r){var n=Array.prototype.slice.call(arguments,2);return r="function"==typeof r?r:e[r],function(t){return n.push(t),r.apply(e,n)}},e.Q.use=function(n){var t=Array.prototype.slice.call(arguments,1);if("string"==typeof n)n=e.Q[n];else if(r(n))return n;return n.bind.apply(n,[n].concat(t))},e.Q.try=function(r,n){if("function"==typeof r)return function(){var t=Array.prototype.slice.call(arguments,0);return e.Q.try(r.apply(this,t),n)};var t=new e.Deferred;setTimeout(function(){e.when(r).done(function(e){t.resolve(e)}).fail(function(){t.resolve(n)})},1);var o=t.promise();return o.or=function(e){return n=e,this},o},e.Q.not=function(r){if("function"==typeof r)return function(){var n=Array.prototype.slice.call(arguments,0);return e.Q.not(r.apply(this,n))};var n=new e.Deferred;return e.when(r).done(function(e){n.reject(e)}).fail(function(e){n.resolve(e)}),n.promise()},e.Q.anyOf=function(r){r=r instanceof Array?r:Array.prototype.slice.call(arguments,0);var n=new e.Deferred,t=[];if(!r.length)throw new Error("$.Q.anyOf called with no parameters");return r.forEach(function(e){"function"==typeof e&&(e=e()),e.done(function(e){n.resolve(e)}).fail(function(e){t.push(e),t.length===r.length&&n.reject(t)})}),n.promise()},e.Q.someOf=function(r){r=r instanceof Array?r:Array.prototype.slice.call(arguments,0);var n=[],t=new Array(r.length),o=0,f=new e.Deferred,i=new Array(r.length),c=0;if(!r.length)throw new Error("$.Q.someOf called with no parameters");return r.forEach(function(e,u){"function"==typeof e&&(e=e()),n[u]=!1,e.done(function(e){n[u]=!0,t[u]=e;for(var i=0;i<n.length;i++)if(!n[i])return f.notify({pct:100*++o/r.length,msg:"",results:t}),!1;f.resolve(t)}).fail(function(e){n[u]=!0,c++,i[u]=e;for(var a=0;a<n.length;a++)if(!n[a])return f.notify({pct:100*++o/r.length,msg:"",results:t}),!1;c<t.length?f.resolve(t):f.reject(i)})}),f.promise()},e.Q.someFrom=function(r){var n=[],t=[],o=0,f=new e.Deferred;for(var i in r)t[o]=i,n[o]=r[i],o++;return e.when(e.Q.someOf(n)).done(function(e){var r={};t.forEach(function(n,t){r[n]=e[t]}),f.resolve(r)}).fail(function(e){var r={};t.forEach(function(n,t){r[n]=e[t]}),f.reject(r)}),f.promise()},e.Q.wait=function(r,n){var t=new e.Deferred,o=t.promise();return o.id=setTimeout(function(){t.resolve(n)},r),o},e.Q.pipe=function(){var r=Array.prototype.slice.call(arguments,0),n=0,t=new e.Deferred,o=function(e,r){return"function"==typeof e?e(r):e},f=function(e){t.reject(e)},i=function(c){return++n,t.notify({pct:parseInt(100*n/r.length),msg:n+"/"+r.length,done:n,total:r.length,result:c}),n>=r.length?(t.resolve(c),!0):void e.when(o(r[n],c)).done(i).fail(f)};return e.when(o(r[0])).done(i).fail(f),t.promise()},e.Q.defer=function(r){var n=Array.prototype.slice.call(arguments,1),t=new e.Deferred,o={handlesError:void 0,fn:r,timeout:500,scope:r};if("object"==typeof r&&e.extend(o,r),o.fn.length>n.length)for(var f=o.fn.length-n.length,i=void 0===o.handlesError||o.handlesError?2:1;f>i;)n.push(void 0),f--;if(!(o.fn.length>n.length))throw new Error("No success callback for method?");if(n.push(function(e){t.resolve(e)}),o.fn.length>n.length)n.push(function(e){t.reject(e)});else{if(o.handlesError)throw new Error("No error callback for method?");o.timeout&&setTimeout(function(){t.reject("timeout")},o.timeout)}if(o.fn.length>n.length)throw new Error("Invalid argument list");try{o.fn.apply(o.scope,n)}catch(c){t.reject(c)}return t.promise()},e.Q.deferObject=function(r,n,t){var o=new e.Deferred,f="onprogress";n=n||"onload onloadend",t=t||"onerror onabort",n.split(" ").forEach(function(e){r[e]=function(e){o.resolve(e)}}),t.split(" ").forEach(function(e){r[e]=function(e){o.reject(e)}}),f.split(" ").forEach(function(e){r[e]=function(e){o.progress(e)}});var i=o.promise();return i.target=r,i.do=function(e){try{for(var n in e)e.hasOwnProperty(n)&&r[n].apply(r,e[n])}catch(t){o.reject(t)}return i},i.set=function(e){try{for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n])}catch(t){o.reject(t)}return i},i},e.Q.parallel=function(r){return r=r instanceof Array?r:Array.prototype.slice.call(arguments,0),e.when.apply(e,r)},e.Q.debug={success:function(r){return(new e.Deferred).resolve(r)},failure:function(r){return(new e.Deferred).reject(r)}}}(jQuery);
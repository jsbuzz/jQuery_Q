/*! jQuery.Q.js - v1.1 - 2014-03-12
* https://github.com/jsbuzz/jQuery_Q
* Copyright (c) 2014 Matyas Buczko; Licensed GPL2 */
(function(e){e.Q=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(e,t)}};e.Q.bound=function(e,t){var n=Array.prototype.slice.call(arguments,2);t=typeof t==="function"?t:e[t];return function(r){n.push(r);return t.apply(e,n)}};e.Q.use=function(e){var t=Array.prototype.slice.call(arguments,0);return e.bind.apply(e,t)};e.Q.anyway=function(t,n){if(typeof t==="function"){return function(){var r=Array.prototype.slice.call(arguments,0);return e.Q.anyway(t.apply(this,r),n)}}var r=new e.Deferred;e.when(t).done(function(e){r.resolve(e)}).fail(function(){r.resolve(n)});var i=r.promise();i.or=function(e){n=e;return this};return i};e.Q.not=function(t){if(typeof t==="function"){return function(){var n=Array.prototype.slice.call(arguments,0);return e.Q.not(t.apply(this,n))}}var n=new e.Deferred;e.when(t).done(function(e){n.reject(e)}).fail(function(e){n.resolve(e)});return n.promise()};e.Q.anyOf=function(t){t=t instanceof Array?t:Array.prototype.slice.call(arguments,0);var n=new e.Deferred,r=[];t.forEach(function(e){if(typeof e==="function"){e=e()}e.done(function(e){n.resolve(e)}).fail(function(e){r.push(e);if(r.length===t.length){n.reject(r)}})});return n.promise()};e.Q.someOf=function(t){t=t instanceof Array?t:Array.prototype.slice.call(arguments,0);var n=[],r=[],i=0,s=new e.Deferred,o=[];t.forEach(function(e,u){if(typeof e==="function"){e=e()}n[u]=false;r[u]=undefined;e.done(function(e){n[u]=true;r[u]=e;for(var o=0;o<n.length;o++){if(!n[o]){s.notify({pct:100*++i/t.length,msg:"",results:r});return false}}s.resolve(r)}).fail(function(e){n[u]=true;o.push(e);for(var a=0;a<n.length;a++){if(!n[a]){s.notify({pct:100*++i/t.length,msg:"",results:r});return false}}if(o.length<r.length){s.resolve(r)}else{s.reject(o)}})});return s.promise()};e.Q.someFrom=function(t){var n=[],r=[],i=[],s=false,o=0,u=new e.Deferred;var a=0;for(var f in t){if(!t.hasOwnProperty(f)){continue}n[a]=t[f];i[a]=f;r[a]=false;a++}n.forEach(function(e,t){e.done(function(e){r[t]=true;if(!s){s={}}s[i[t]]=e;for(var a=0;a<r.length;a++){if(!r[a]){u.notify({pct:100*++o/n.length,msg:"",results:s});return false}}u.resolve(s)}).fail(function(){r[t]=true;for(var e=0;e<r.length;e++){if(!r[e]){u.notify({pct:100*++o/n.length,msg:"",results:s});return false}}if(s){u.resolve(s)}else{u.reject()}})});return u.promise()};e.Q.wait=function(t,n){var r=new e.Deferred;setTimeout(function(){r.resolve(n)},t);return r.promise()};e.Q.pipe=function(){var t=Array.prototype.slice.call(arguments,0),n=false,r=0,i=new e.Deferred;var s=function(e,t){return typeof e==="function"?e(t):e},o=function(e){i.reject(e)},u=function(n){++r;if(r>=t.length){i.resolve(n);return true}e.when(s(t[r],n)).done(u).fail(o);i.notify({pct:100*r/t.length,msg:"",result:n})};e.when(s(t[0])).done(u).fail(o);return i.promise()};e.Q.defer=function(t){var n=Array.prototype.slice.call(arguments,1),r=new e.Deferred,i=500,s=t;if(!n.length&&typeof t==="object"){var o=t;n=o.params||[];i=o.timeout||i;s=o.scope||o;t=o.fn}if(t.length>n.length){n.push(function(e){r.resolve(e)})}else{throw new Error("No success callback for method?")}if(t.length>n.length){n.push(function(e){r.reject(e)})}else{setTimeout(function(){r.reject("timeout")},i)}if(t.length>n.length){throw new Error("Invalid argument list")}try{t.apply(s,n)}catch(u){r.reject(u)}return r.promise()}})(jQuery)

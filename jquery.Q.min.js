/*! jQuery.Q.js - v1.1 - 2014-03-12
* https://github.com/jsbuzz/jQuery_Q
* Copyright (c) 2014 Matyas Buczko; Licensed GPL2 */
!function(e){"use strict";function r(e){return(typeof e.done+typeof e.fail+typeof e.state).match(/(function){3}/)}e.Q=function(n){var t=Array.prototype.slice.call(arguments,1);if("string"==typeof n)n=e.Q[n];else if(r(n))return n;return function(){return n.apply(n,t)}},e.Q.use=function(n){var t=Array.prototype.slice.call(arguments,1),o=!1;if("string"==typeof n)n=e.Q[n],o=!0;else if(r(n))return n;return function(r){return"undefined"!=typeof r&&t.push(o?new e.Q._result(r):r),n.apply(n,t)}},e.Q.bound=function(e,r){var n=Array.prototype.slice.call(arguments,2);return r="function"==typeof r?r:e[r],function(t){return n.push(t),r.apply(e,n)}},e.Q.apply=function(e){var r=Array.prototype.slice.call(arguments,1);return function(n){return e="function"==typeof e?e:n[e],e.apply(n,r)}},e.Q.try=function(r,n){if("function"==typeof r)return function(){var t=Array.prototype.slice.call(arguments,0);return e.Q.try(r.apply(this,t),n)};var t=new e.Deferred;setTimeout(function(){e.when(r).done(function(e){t.resolve(e)}).fail(function(){t.resolve(n)})},1);var o=t.promise();return o.or=function(e){return n=e,this},o},e.Q.not=function(r){var n=Array.prototype.slice.call(arguments,1);if("function"==typeof r)return function(){return n=n.concat(Array.prototype.slice.call(arguments)),e.Q.not(r.apply(this,n))};var t=new e.Deferred;return e.when(r).done(function(e){t.reject(e)}).fail(function(e){t.resolve(e)}),t.promise()},e.Q.anyOf=function(r){r=r instanceof Array?r:Array.prototype.slice.call(arguments,0);var n;r.length&&r[r.length-1]instanceof e.Q._result&&(n=r.pop().result);var t=new e.Deferred,o=[];if(!r.length)throw new Error("$.Q.anyOf called with no parameters");return r.forEach(function(e){"function"==typeof e&&(e=e(n)),e.done(function(e){t.resolve(e)}).fail(function(e){o.push(e),o.length===r.length&&t.reject(o)})}),t.promise()},e.Q.someOf=function(r){r=r instanceof Array?r:Array.prototype.slice.call(arguments,0);var n;r.length&&r[r.length-1]instanceof e.Q._result&&(n=r.pop().result);var t=new Array(r.length),o=0,f=new e.Deferred,i=new Array(r.length),u=0;if(!r.length)throw new Error("$.Q.someOf called with no parameters");var c=function(){return f.notify({pct:100*++o/r.length,msg:"",results:t}),o>=r.length};return r.forEach(function(e,r){"function"==typeof e&&(e=e(n)),e.done(function(e){t[r]=e,c()&&f.resolve(t)}).fail(function(e){u++,i[r]=e,c()&&(u<t.length?f.resolve(t):f.reject(i))})}),f.promise()},e.Q.someFrom=function(r,n){var t=[],o=[],f=0,i=new e.Deferred,u=function(e){var r={};return o.forEach(function(n,t){r[n]=e[t]}),r};for(var c in r)o[f]=c,t[f]=r[c],f++;return n instanceof e.Q._result&&t.push(n),e.when(e.Q.someOf(t)).done(function(e){i.resolve(u(e))}).fail(function(e){i.reject(u(e))}).progress(function(e){i.notify(e)}),i.promise()},e.Q.allOf=function(r){r=r instanceof Array?r:Array.prototype.slice.call(arguments,0);var n;return r.length&&r[r.length-1]instanceof e.Q._result&&(n=r.pop().result),r.forEach(function(e,t){"function"==typeof e&&(r[t]=e(n))}),e.when.apply(e,r)},e.Q.pipe=function(){var r=Array.prototype.slice.call(arguments,0),n=0,t=new e.Deferred,o=function(e,r){return"function"==typeof e?e(r):e},f=function(e){t.reject(e)},i=function(){var u=Array.prototype.slice.call(arguments);return 1===u.length&&(u=u[0]),++n,t.notify({pct:parseInt(100*n/r.length),msg:n+"/"+r.length,done:n,total:r.length,result:u}),n>=r.length?(t.resolve(u),!0):void e.when(o(r[n],u)).done(i).fail(f)};return e.when(o(r[0])).done(i).fail(f),t.promise()},e.Q.wait=function(r,n){var t=new e.Deferred,o=t.promise();return n instanceof e.Q._result&&(n=n.result),o.id=setTimeout(function(){t.resolve(n)},r),o},e.Q.debug={success:function(r){return(new e.Deferred).resolve(r)},failure:function(r){return(new e.Deferred).reject(r)},pending:function(){return(new e.Deferred).promise()}},e.Q._result=function(e){this.result=e},e.Q.defer=function(r){var n=Array.prototype.slice.call(arguments,1),t=new e.Deferred,o={handlesError:void 0,fn:r,timeout:500,scope:r};if("object"==typeof r&&e.extend(o,r),o.fn.length>n.length)for(var f=o.fn.length-n.length,i=void 0===o.handlesError||o.handlesError?2:1;f>i;)n.push(void 0),f--;if(!(o.fn.length>n.length))throw new Error("No success callback for method?");if(n.push(function(e){t.resolve(e)}),o.fn.length>n.length)n.push(function(e){t.reject(e)});else{if(o.handlesError)throw new Error("No error callback for method?");o.timeout&&setTimeout(function(){t.reject("timeout")},o.timeout)}try{o.fn.apply(o.scope,n)}catch(u){t.reject(u)}return t.promise()},e.Q.deferObject=function(r,n,t){var o=new e.Deferred,f="onprogress";n=n||"onload onloadend",t=t||"onerror onabort",n.split(/[\s]+/).forEach(function(e){r[e]=function(e){o.resolve(e)}}),t.split(/[\s]+/).forEach(function(e){r[e]=function(e){o.reject(e)}}),f.split(/[\s]+/).forEach(function(e){r[e]=function(e){o.progress(e)}});var i=o.promise();return i.target=r,i.do=function(e){try{for(var n in e)e.hasOwnProperty(n)&&r[n].apply(r,e[n])}catch(t){o.reject(t)}return i},i.set=function(e){try{for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n])}catch(t){o.reject(t)}return i},i}}(jQuery);